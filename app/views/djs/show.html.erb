<div class="row page-header title">
  <h2 class='col-md-5'> <%= @dj.name %>  </h2>

  <%= render 'dj_search' %>

</div>
<div class="dj-profile">
  <div class="row">
      <div class= "edit-or-contact col-md-2 pull-right">

      <% if current_user && current_user.dj_status && current_user.sdcl_id == @dj.sdcl_id %>
          <button class="edit-dj pull-right btn btn-primary">Edit your profile</button>
        <br>
      <%else%>

       <%= render 'contact_modal' %>
   
        <a href="#" data-toggle="modal" data-target="#basicModal" >
          <div class="hover-mask bottom-mask mask-orange">
            <h2 class='hire-dj btn-centered btn btn-info pull-right'>Contact</h2>
          </div>
        </a>
      <%end%>

      </div>
 

<!-- ///////////  PROFILE //////////////////////////////// -->
  <div id="dj-profile">
  
    <div class="profile-pic col-md-3">
      <%= link_to image_tag(@dj.image_url), dj_path(@dj.slugify), class: 'profile-image' %>
    </div>
    <div class="dj-info col-md-5 col-md-offset-1 vertical-center">   
      <div class="other-info">

        <%= render 'dj_info' %>
      
        DJB Rating<sup>beta</sup>:
        <div id='star'>
     
        </div>
      </div>
    <% if !logged_in? || current_user.sdcl_id != @dj.sdcl_id %>
    
    <div class='rate-button btn-centered btn btn-default'>Review <%=@dj.name%></div>
    <%end%>

  <div class="rate-dj text-center">
    <% if logged_in? && current_user.sdcl_id != @dj.sdcl_id %>

      <p><strong>What'd you think of <%= @dj.name %>?</strong><br>


      <div class="user-rate">
        <div id='user_star'>

        </div></p>
        <%= simple_form_for(@comment, url: comment_path(@comment), method: "patch") do |f| %>
    
    
          <%= f.input :body, label: "Click on a star above and comment below.", required: false, hint: "For your feedback to be recorded, you must give both a comment of ~2-3 sentences as well as a rating.", placeholder: "Where'd you see her? How'd he do? (min 30 characters).", input_html: { minlength: 30, rows: 4,  class: "form-control comment" }%>

      

          <%= f.button :submit, class: "btn btn-default submit-comment"%>

        <%end%>
        <a href="#"><div class="done-rating cancel-comment" style="color: red;">Cancel</div></a>
      </div>
    <%elsif !logged_in?%>
      <div class="text-center bg-warning">
      <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span><strong> You must be logged in to add a rating.</strong>

      
      <h4><%= link_to 'Sign in with Facebook', '/auth/facebook'%>
      | <%= link_to 'Back', '#', class: 'text-center done-rating'%></h4>   </div>
     <%end%> 
 
      </div>
    </div>
  </div>
    <br>
    </div>
    <br><br>

   <% if @comments %>

   <h5 class="comments-title">Reviews</h5>

     <%= render 'reviews' %><br>
<br>
    
    <div class="tracks">
      <h5 class="tracks-title">SoundCloud Streams</h5>
      <% if !@dj.tracks.blank? %>

        <%= render 'tracks' %><br>

      <%end%>
    </div>


  <%else%>
      <div class="tracks col-md-12">
    <% if !@dj.tracks.blank? %>

    <%= render 'tracks' %><br>

    <%end%>
  </div>
  <%end%>


<!-- ////////////// form-begin ///////////////////////-->

  <div class="row">
    <div class="update-form col-md-10 col-md-offset-1">

    <%= render 'form' if current_user && current_user.dj_status && current_user.sdcl_id == @dj.sdcl_id %><br>

    <button class="cancel-edit btn-centered btn">Cancel</button> <br>
    </div>
  </div>
</div>


<script>
  $('#star').raty({
    readOnly: true,
    score: <%= @dj.average_rating %>,
    path: '/assets'
  });


  $('#user_star').raty({
    score: <%= @rating.score %>,
    cancel: true,
    path: '/assets',
    click: function(score, evt) {
      $.ajax({
        url: '/ratings/' + <%= @rating.id %>,
        type: 'PATCH',
        data: { score: score }
      });
    }
  });



</script>
