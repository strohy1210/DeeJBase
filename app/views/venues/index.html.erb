
  <div class="row header rate-music-header">
    <div class="title">
    <h2 class="text-center" id="rate-the-music"> rate the music. </h2>
    </div>
<!-- <div class="search-venues">

</div> -->
  </div>
<div class="venue-list container-fluid">
<div id="results">
  <br>
<% @venues.each_with_index do |venue, i| %>
  <% if i%3 == 0  %>
    <div class='dj-item grey-overlay'>
  
  <%elsif i%3 == 1%>
    <div class='dj-item red-overlay'>
  <%else%>

    <div class='dj-item brown-overlay'>

  <%end%>
     <a href="/venues/<%=venue.slugify%>">
    <div class="row">
    <div class= "dj-header col-md-4 col-md-offset-1">
      <h2><%=venue.name.titleize%></h2>
        <% if !venue.neighborhood.blank? %>     
          <h4><%= venue.neighborhood.name %></h4>
        <% end%>
        <div class='overlay'>
        <div style="color:#2A2222;"><%= venue.category.singularize if venue.category %></div> 
        
        <div id="star<%=venue.id%>" class="djb" data-score=<%= venue.average_rating%>>
         Music Rating<sup></sup>:
        </div>

       </div>        
    </div>

        <div class="preview col-md-5 col-md-offset-1">
          <% comments = venue.comments.select {|c| c.is_valid? && c.valid? && c.rating.valid? && c.rating.score != 0} if venue.comments.any?  %>
          <% if comments && comments.any? %>
        <em><%=truncate(comments.last.body, length: 300, separator: " ") %></em>
        <%else%>
          <em>Be the first to review <%=venue.name%>'s music.</em>
        <%end%>
      </div>
</h6>
    </div>


  </div></a>

<% end %> 
        <br><br>
<div id="infinite-scrolling">
  <%= will_paginate @venues %>
</div>


<script type="text/javascript">
  <% @venues.each do |venue| %>
   $("#star<%=venue.id%>").raty({
      readOnly: true,
      score: function() {
        return $(this).attr('data-score');
      },
      path: '/assets'
    });
  <%end%>


</script>


