
  <div class="row header">
    <div class="title">
    <h3 class="text-center" id="rate-the-music"> Rate the music. </h3>
    </div>
<!-- <div class="search-venues">

</div> -->
  </div>
<div class="venue-list container-fluid">
<div id="results">
<ul>
<% @venues.each do |venue| %>
   
  <div class='dj-item'>
     <a href="/venues/<%=venue.slugify%>">
    <div class="row">
    <div class= "dj-header col-md-4 col-md-offset-1">
      <h2><%=venue.name.titleize%></h2>
        <% if !venue.neighborhood.blank? %>     
          <h4><%= venue.neighborhood.name %></h4>
        <% end%>
        <div class='overlay'>
        <div style="color:#403D3D;"><%= venue.category.singularize if venue.category %></div> 
        
        <div id="star<%=venue.id%>" class="djb" data-score=<%= venue.average_rating%>>
         Music Rating<sup></sup>:
        </div>

       </div>        
    </div>

        <div class="preview col-md-5 col-md-offset-1">
          <% comments = venue.comments.select {|c| c.is_valid? && c.valid? && c.rating.valid? && c.rating.score != 0} if venue.comments.any?  %>
        <em><%=truncate(comments.last.body, length: 300, separator: " ") if comments && comments.any? %></em>
      </div>
</h6>
    </div>


  </div></a>
  <br>
<% end %>
   
        <br><br>
<div id="infinite-scrolling">
  <%= will_paginate @venues %>
</div>
</ul>

<script type="text/javascript">
  <% @venues.each do |venue| %>
   $("#star<%=venue.id%>").raty({
      readOnly: true,
      score: function() {
        return $(this).attr('data-score');
      },
      path: '/assets'
    });
  <%end%>


</script>


