
<div class="row page-header">
  <div class="title col-md-7 col-xs-5">
  <h3> <strong>PARTY > RATE THE DJ > REPEAT</strong> </h3>
  </div>

  <%= form_tag(search_path, method: 'get', class: "search-djs navbar-form pull-right", role: "search") do %>
    <div class="input-group">
        <input type="text" class="form-control" placeholder="Chainsmokers" name="name">
        <div class='input-group-btn'>       
        <button class="btn btn-default" type="submit">Find DJs <i class="glyphicon glyphicon-search"></i></button>
      </div>
    </div>
    <% end %>
</div>

<div id="results">
<ul>
<% @djs.each do |dj| %>
    
  <div class='dj-item'>

    <div class= "dj-header">
      <h3><%= link_to dj.name.titleize, dj_path(dj.slugify) %></h3>
    
    </div>
    <div class="row">
      <p><div class="index-image col-md-3">
        <%= link_to image_tag(dj.image_url), dj_path(dj.slugify) %>
      </div></p>

  <%= link_to dj_path(dj.slugify) do %>
      <div class="bio col-md-8">
        <div class='overlay'>
        <%if dj.bio %>
        <% if !dj.genres.blank? %>     
          <h4>Genres: <%= dj.genres.map {|g| g.name}.join(", ") %></h4>
        <% end%>
        <% if !dj.fb_likes.blank? %>
       <%end%>


           <h5> located in <%= dj.city %> </h5>
        <%end%>
        <% if !dj.average_rating.blank? %>
         <%if !dj.rate.blank? %>
        <h6 style="color: black;"><%= dj.rate %> per night</h6>
        <%end%>
        <div id="star<%=dj.id%>" class="djb" data-score=<%= dj.average_rating%>>
          Rating<sup>beta</sup>:
        </div>
        <%end%>
       </div>
      </div>
<% end %>
    </div>
    <br>

      <p><div class="demo-embed">
        <% if dj.tracks.any? %>
        <% track=dj.tracks.where.not(demo: nil)[0] %>
        <%= track.demo.html_safe %>
        <% end%>
      </div></p>


  </div>
  <br>
<% end %>
   
        <br><br>
<div id="infinite-scrolling">
  <%= will_paginate @djs %>
</div>
</ul>

<script type="text/javascript">
  <% @djs.each do |dj| %>
    $("#star<%=dj.id%>").raty({
      readOnly: true,
      score: function() {
        return $(this).attr('data-score');
      },
      path: '/assets'
    });
  <%end%>
</script>


